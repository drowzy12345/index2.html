<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FiveM Phaze Menu</title>
<style>
body {
    margin:0; padding:0; font-family:'Segoe UI',sans-serif;
    background:rgba(0,0,0,0.7);
    display:flex; justify-content:center; align-items:center; height:100vh;
}

#menu {
    display:flex; width:450px; height:520px;
    border-radius:12px; overflow:hidden;
    background:#181818; box-shadow:0 0 25px rgba(0,0,0,0.8);
    animation:fadeIn 0.3s ease;
}

@keyframes fadeIn {
    0% {opacity:0; transform:scale(0.95);}
    100% {opacity:1; transform:scale(1);}
}

/* Sidebar */
#sidebar {
    width:140px; background:#1b1b1b; border-right:2px solid #ff4757;
    display:flex; flex-direction:column;
}

.sidebar-item {
    padding:16px 10px; text-align:center; color:#aaa; cursor:pointer;
    font-weight:600; font-size:0.95em; display:flex; flex-direction:column;
    align-items:center; transition:0.25s all;
}
.sidebar-item span { font-size:0.7em; margin-top:4px; opacity:0.7; }
.sidebar-item.active, .sidebar-item:hover {
    background:#ff4757; color:#fff;
}

/* Content Panel */
#content {
    flex:1; padding:15px; background:#222; overflow-y:auto; display:flex; flex-direction:column;
}
#content::-webkit-scrollbar { width:8px; }
#content::-webkit-scrollbar-track { background:#1c1c1c; }
#content::-webkit-scrollbar-thumb { background:#ff4757; border-radius:4px; }

/* Buttons */
.btn {
    width:100%; padding:14px; margin:6px 0; background:#2c2c2c; color:#fff;
    border:none; border-radius:6px; cursor:pointer; font-weight:600;
    text-align:left; padding-left:15px; transition:0.25s all; position:relative;
}
.btn:hover, .btn.active { background:#ff4757; box-shadow:0 0 8px rgba(255,71,87,0.6); }

/* Inputs & sliders */
input[type="text"], select, input[type="range"] {
    width:100%; margin:6px 0 12px 0; border-radius:6px; padding:10px;
    border:1px solid #444; background:#2a2a2a; color:#fff; font-weight:500;
}
input[type="text"]:focus, select:focus, input[type="range"]:focus {
    border:1px solid #ff4757; box-shadow:0 0 6px rgba(255,71,87,0.4); outline:none;
}
</style>
</head>
<body>

<div id="menu">
    <div id="sidebar"></div>
    <div id="content"></div>
</div>

<script>
const menuStructure = [
    {
        label:'Self Options', icon:'🧍', submenu:[
            {label:'Heal', type:'button'},
            {label:'Armor', type:'button'},
            {label:'Custom Value', type:'input'},
            {label:'Checkbox Test', type:'checkbox', checked:false},
            {label:'Slider Test', type:'slider', min:0, max:100, value:50},
            {label:'Scroll Test', type:'scroll', options:['Option1','Option2','Option3'], selected:0},
            {label:'Live Submenu', type:'submenu', dynamic:true, getSubMenu:(cb)=>cb([{label:'Dynamic Option', type:'button'}])}
        ]
    },
    {
        label:'Server Options', icon:'🖥️', submenu:[
            {label:'Server Button', type:'button'}
        ]
    },
    {
        label:'Dynamic Triggers', icon:'⚡', submenu:[
            {label:'Trigger Button', type:'button'}
        ]
    }
];

let activeSidebar = 0, activeBtn = 0;
let menuStack = [{menu:menuStructure, sidebar:activeSidebar, btn:activeBtn}];

function renderMenu() {
    const sidebar = document.getElementById('sidebar');
    const content = document.getElementById('content');
    const current = menuStack[menuStack.length-1];

    sidebar.innerHTML='';
    content.innerHTML='';

    current.menu.forEach((item,i)=>{
        const el = document.createElement('div');
        el.className='sidebar-item'+(i===current.sidebar?' active':'');
        el.innerHTML=item.label+'<span>'+item.icon+'</span>';
        el.onclick=()=>{ current.sidebar=i; current.btn=0; renderMenu(); };
        sidebar.appendChild(el);
    });

    const activeTab = current.menu[current.sidebar];
    if(!activeTab || !activeTab.submenu) return;

    activeTab.submenu.forEach((btn,i)=>{
        const b = document.createElement('button');
        b.className='btn'+(i===current.btn?' active':'');
        b.innerText=btn.label;
        b.onclick=()=>handleAction(btn);
        content.appendChild(b);

        if(btn.type==='slider'){
            const input=document.createElement('input');
            input.type='range'; input.min=btn.min; input.max=btn.max; input.value=btn.value;
            input.oninput=e=>btn.value=e.target.value;
            input.onchange=()=>handleAction(btn);
            content.appendChild(input);
        }
        if(btn.type==='scroll'){
            const select=document.createElement('select');
            btn.options.forEach((opt,idx)=>{ const o=document.createElement('option'); o.text=opt; o.value=idx; if(idx===btn.selected) o.selected=true; select.appendChild(o); });
            select.onchange=()=>{ btn.selected=parseInt(select.value); handleAction(btn); };
            content.appendChild(select);
        }
        if(btn.type==='checkbox'){
            const input=document.createElement('input'); input.type='checkbox'; input.checked=btn.checked;
            input.onchange=()=>{ btn.checked=input.checked; handleAction(btn); };
            content.appendChild(input);
        }
        if(btn.type==='input'){
            const input=document.createElement('input'); input.type='text'; input.placeholder='Enter value';
            input.onchange=()=>handleAction({label:btn.label,value:input.value});
            content.appendChild(input);
        }
    });
}

function handleAction(btn){
    if(btn.type==='submenu'){
        if(btn.submenu) menuStack.push({menu:btn.submenu, sidebar:0, btn:0});
        else if(btn.dynamic && typeof btn.getSubMenu==='function'){
            btn.getSubMenu(submenu=>{ btn.submenu=submenu; menuStack.push({menu:submenu, sidebar:0, btn:0}); renderMenu(); });
            return;
        }
    } else {
        fetch(`https://${GetParentResourceName()}/action`,{
            method:'POST', headers:{'Content-Type':'application/json'},
            body:JSON.stringify({action:btn.label,value:btn.value})
        });
    }
    renderMenu();
}

document.addEventListener('keydown', e=>{
    const current = menuStack[menuStack.length-1];
    const activeTab = current.menu[current.sidebar];
    if(!activeTab || !activeTab.submenu) return;

    const maxBtn = activeTab.submenu.length;
    if(e.key==='ArrowUp'){ current.btn--; if(current.btn<0) current.btn=maxBtn-1; renderMenu(); }
    if(e.key==='ArrowDown'){ current.btn++; if(current.btn>=maxBtn) current.btn=0; renderMenu(); }
    if(e.key==='ArrowLeft'){ current.sidebar--; if(current.sidebar<0) current.sidebar=current.menu.length-1; current.btn=0; renderMenu(); }
    if(e.key==='ArrowRight'){ current.sidebar++; if(current.sidebar>=current.menu.length) current.sidebar=0; current.btn=0; renderMenu(); }
    if(e.key==='Enter') handleAction(activeTab.submenu[current.btn]);
    if(e.key==='Backspace'){ if(menuStack.length>1){ menuStack.pop(); renderMenu(); } }
});

renderMenu();
</script>
</body>
</html>
